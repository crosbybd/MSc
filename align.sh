#!/bin/bash
#SBATCH --ntasks=4
#SBATCH --cpus-per-task=4
#SBATCH --mem=32G
#SBATCH --mail-type=ALL
#SBATCH --mail-user=b.crosby@queensu.ca
#SBATCH -t 7-00:00:00
#SBATCH -o /global/home/hpc3737/Scripts/align.out
#SBATCH -e /global/home/hpc3737/Scripts/align.err
#SBATCH --account=con-hpcg1492
#SBATCH --partition=reserved

##########################################
#                                        #
# Script - Aligning reads to a reference #
#                                        #
##########################################


date >> ~/Scripts/align.out
date >> ~/Scripts/align.err



# Concatenate process_radtags output from both lanes into one (only for Anna's data)

# PLATE 1
N=1
for SAMPLE in CO1H CO2H CO4H CO5H CO6H CO7H CO8H CO11H CO9H CO12H CO13H CO14H CO15H CO16H CO17H CO18H CO19H CO20H CO21H \
CO22H CO23H CO24H CO25H CO26H TB30H TB31H TB32H CO30H CO31H CO32H CO33H CO34H CO35H CO36H CO37H CO38H CO39H CO40H CO41H \
CO42H CO43H CO44H CO45H CO46H CO47H CO48H CO49H CO50H TB1H TB2H TB4H TB5H TB7H TB8H TB9H TB10H TB11H TB12H TB13H TB15H \
TB16H TB17H TB18H TB19H TB20H TB22H TB24H TB25H TB26H TB27H TB28H TB29H CO27H CO28H CO29H TB33H TB34H TB35H TB36H TB37H \
TB38H TB39H TB40H TB41H TB42H TB43H TB44H TB45H TB46H TB47H TB48H TB49H TB50H COMU-GI-1U COMU-GI-2U COMU-GI-4U
do
	((i=i%N)); ((i++==0)) && wait
	cat ~/post_procrad/lane1/plate1/${SAMPLE}.1.fq.gz ~/post_procrad/lane2/plate1/${SAMPLE}.1.fq.gz > ~/post_procrad/${SAMPLE}.1.fq.gz &
	cat ~/post_procrad/lane1/plate1/${SAMPLE}.2.fq.gz ~/post_procrad/lane2/plate1/${SAMPLE}.2.fq.gz > ~/post_procrad/${SAMPLE}.2.fq.gz &
	cat ~/post_procrad/lane1/plate1/${SAMPLE}.rem.1.fq.gz ~/post_procrad/lane2/plate1/${SAMPLE}.rem.1.fq.gz > ~/post_procrad/rem/${SAMPLE}.rem.1.fq.gz &
	cat ~/post_procrad/lane1/plate1/${SAMPLE}.rem.2.fq.gz ~/post_procrad/lane2/plate1/${SAMPLE}.rem.2.fq.gz > ~/post_procrad/rem/${SAMPLE}.rem.2.fq.gz &
done


# PLATE 2
for SAMPLE in COMU-GI-6U COMU-GI-7U COMU-GI-8U COMU-GI-9U COMU-GI-10U COMU-GI-29B COMU-GI-30B COMU-GI-31B COMU-GI-32B COMU-GI-33B \
COMU-GI-34B COMU-GI-35B COMU-GI-36B COMU-GI-37B COMU-GI-38B COMU-UN-FI2 COMU-UN-FI3 COMU-UN-FI4 COMU-UN-FI5 COMU-BR-FI6 \
COMU-BR-FI7 COMU-BR-FI8 COMU-BR-FI10 COMU-BR-FI12 COMU-BR-FI13 COMU-BR-FI14 COMU-BR-FI15 COMU-BR-FI16 COMU-UN-FI17 \
COMU-UN-FI18 COMU-UN-FI19 COMU-UN-FI20 COMU-GC031-UN COMU-GC034-BR COMU-GC037-UN COMU-GC041-UN COMU-GC068-UN \
COMU-GC069-UN COMU-GC070-UN COMU-GC071-UN COMU-GC072-BR COMU-GC073-UN COMU-GC074-UN COMU-GC075-BR CM1-BR CM2-BR CM3-NOT \
COMU-CMI-1 COMU-CMI-2 COMU-CMI-3 COMU-CMI-6 COMU-CMI-7 COMU-CMI-8 COMU-CMI-10 COMU-CMI-12 COMU-CMI-13 COMU-CMI-14 \
COMU-CMI-15 COMU-CMI-17 COMU-CMI-18 COMU-CMI-19 COMU-Bu-400 COMU-Bu-441 COMU-Bu-444 COMU-Bu-445 COMU-Bu-472 COMU-Bu-474 \
COMU-Bu-480 COMU-Bu-481 COMU-Bu-486 COMU-Bu-496 COMU-Bu-503 COMU-Bu-504 COMU-Bu-605 COMU-Bu-606 COMU-Bu-612 COMU-Bu-615 \
COMU-Bu-630 COMU-UAIM-9 COMU-UAIM-10 COMU-UAIM-11 COMU-UAIM-12 COMU-UAIM-14 COMU-UAIM-15 COMU-UAIM-17 COMU-UAIM-18 \
COMU-UAIM-21 COMU-UAIM-22 COMU-UAIM-23 COMU-UAIM-24 COMU-UAIM-25 COMU-UAIM-26 COMU-UAIM-27 COMU-UAIM-28 COMU-UAIM-29 \
COMU-UAIM-30
do
	((i=i%N)); ((i++==0)) && wait
	cat ~/post_procrad/lane1/plate2/${SAMPLE}.1.fq.gz ~/post_procrad/lane2/plate2/${SAMPLE}.1.fq.gz > ~/post_procrad/${SAMPLE}.1.fq.gz &
	cat ~/post_procrad/lane1/plate2/${SAMPLE}.2.fq.gz ~/post_procrad/lane2/plate2/${SAMPLE}.2.fq.gz > ~/post_procrad/${SAMPLE}.2.fq.gz &
	cat ~/post_procrad/lane1/plate2/${SAMPLE}.rem.1.fq.gz ~/post_procrad/lane2/plate2/${SAMPLE}.rem.1.fq.gz > ~/post_procrad/rem/${SAMPLE}.rem.1.fq.gz &
	cat ~/post_procrad/lane1/plate2/${SAMPLE}.rem.2.fq.gz ~/post_procrad/lane2/plate2/${SAMPLE}.rem.2.fq.gz > ~/post_procrad/rem/${SAMPLE}.rem.2.fq.gz &
done


# PLATE 3
for SAMPLE in COMU-Ho-8B COMU-Ho-10B COMU-Ho-15U COMU-Ho-24U COMU-Ho-39U COMU-Ho-41U COMU-Ho-48U COMU-Ho-51B COMU-Ho-59U \
COMU-UaKP99-3 COMU-UaKP99-4 COMU-UaKP99-9 COMU-UaKP99-10 COMU-UaKP99-12 COMU-UaKP99-13 COMU-UaKP99-14 COMU-UaKP99-15 \
COMU-UaKP99-16 COMU-UaKP99-17 COMU-UaKP99-18 COMU-UaKP99-19 COMU-UaKP99-20 COMU-Den-1 COMU-Den-2 Ua-Den-3 Ua-Den-4 \
Ua-Den-5 Ua-Den-6 Ua-Den-8 Ua-Den-9 Ua-Den-10 Ua-Den-11 Ua-Den-12 Ua-Den-13 Ua-Den-15 Ua-Den-16 Ua-Den-17 Ua-Den-18 \
TBMU-FI-1 TBMU-FI-2 TBMU-FI-3 TBMU-FI-4 TBMU-FI-5 TBMU-FI-6 TBMU-FI-7 TBMU-GC-014 TBMU-GC-016 TBMU-GC-017 TBMU-GC-018 \
TBMU-GC-019 TBMU-GC-021 TBMU-GC-024 TBMU-GC-025 TBMU-GC-026 TBMU-GC-027 TBMU-GC-029 TBMU-GC-030 TBMU-GC-032 TBMU-ULA-01 \
TBMU-ULA-02 TBMU-ULA-03 TBMU-ULA-04 TBMU-ULA-05 TBMU-ULA-06 TBMU-ULA-07 TBMU-ULA-08 TBMU-ULA-09 TBMU-ULA-11 TBMU-ULA-12 \
TBMU-ULA-13 TBMU-ULA-14 TBMU-ULA-15 TBMU-ULA-16 TBMU-ULA-18 TBMU-ULA-19 TBMU-ULA-20 TBMU-ULA-21 TBMU-ULA-22 V1 V2 V3 V5 \
V7 V8 V9 V10 V12 V13 V16 V17 V19 TBMU-ULD-1 TBMU-ULD-2 TBMU-ULD-3 TBMU-ULD-4 TBMU-ULD-5
do
	((i=i%N)); ((i++==0)) && wait
	cat ~/post_procrad/lane1/plate3/${SAMPLE}.1.fq.gz ~/post_procrad/lane2/plate3/${SAMPLE}.1.fq.gz > ~/post_procrad/${SAMPLE}.1.fq.gz &
	cat ~/post_procrad/lane1/plate3/${SAMPLE}.2.fq.gz ~/post_procrad/lane2/plate3/${SAMPLE}.2.fq.gz > ~/post_procrad/${SAMPLE}.2.fq.gz &
	cat ~/post_procrad/lane1/plate3/${SAMPLE}.rem.1.fq.gz ~/post_procrad/lane2/plate3/${SAMPLE}.rem.1.fq.gz > ~/post_procrad/rem/${SAMPLE}.rem.1.fq.gz &
	cat ~/post_procrad/lane1/plate3/${SAMPLE}.rem.2.fq.gz ~/post_procrad/lane2/plate3/${SAMPLE}.rem.2.fq.gz > ~/post_procrad/rem/${SAMPLE}.rem.2.fq.gz &
done


# PLATE 4
for SAMPLE in TBMU-ULD-6 TBMU-ULD-8 TBMU-ULD-9 TBMU-ULD-11 TBMU-ULD-12 TBMU-ULD-13 TBMU-ULD-14 TBMU-ULD-15 TBMU-ULD-16 \
TBMU-ULD-17 TBMU-ULD-18 TBMU-ULD-19 TBMU-ULD-20 MW-08-01 MW-08-02 MW-08-03 MW-08-04 MW-08-05 MW-08-06 MW-08-07 MW-08-09 \
MW-08-10 MW-08-11 MW-08-12 MW-08-13 MW-08-14 MW-08-15 MW-08-16 MW-08-17 MW-08-18 MW-08-19 MW-08-20 TBMU-UL-L96-1 \
TBMU-UL-L96-3 TBMU-UL-L96-4 TBMU-UL-L96-5 TBMU-UL-L96-6 TBMU-UL-L96-7 TBMU-UL-L96-8 TBMU-UL-L96-9 TBMU-UL-L96-10 \
TBMU-UL-L96-11 TBMU-UL-L96-12 TBMU-UL-L96-13 TBMU-UL-L96-14 TBMU-UL-L96-15 TBMU-UL-L96-16 TBMU-UL-L96-17 TBMU-UL-L96-18 \
TBMU-UL-L96-19 TBMU-UL-L96-20 TBMU-ULH-584 TBMU-ULH-605 TBMU-ULH-607 TBMU-ULH-608 TBMU-ULH-609 TBMU-ULH-610 TBMU-ULH-611 \
TBMU-ULH-617 TBMU-ULH-618 TBMU-ULH-619 TBMU-ULH-621 TBMU-ULH-622-1 TBMU-ULH-624 TBMU-ULH-625 TBMU-ULH-644 TBMU-ULH-645 \
TBMU-ULH-647 TBMU-ULH-648 TBMU-ULH-649 PLI-04-31 PLI-04-32 PLI-04-33 PLI-08-34 PLI-08-35 PLI-08-36 PLI-08-37 PLI-08-38 \
PLI-08-39 PLI-08-40 PLI-08-41 PLI-08-42 PLI-08-43 PLI-08-44 PLI-08-45 PLI-08-47 PLI-08-48 PLI-08-49 PLI-08-50 TBMU-CB1d \
TBMU-CB2d TBMU-CB2c TBMU-CB6c TBMU-CB7c TBMU-CB8c TBMU-CB9c
do
	((i=i%N)); ((i++==0)) && wait
	cat ~/post_procrad/lane1/plate4/${SAMPLE}.1.fq.gz ~/post_procrad/lane2/plate4/${SAMPLE}.1.fq.gz > ~/post_procrad/${SAMPLE}.1.fq.gz &
	cat ~/post_procrad/lane1/plate4/${SAMPLE}.2.fq.gz ~/post_procrad/lane2/plate4/${SAMPLE}.2.fq.gz > ~/post_procrad/${SAMPLE}.2.fq.gz &
	cat ~/post_procrad/lane1/plate4/${SAMPLE}.rem.1.fq.gz ~/post_procrad/lane2/plate4/${SAMPLE}.rem.1.fq.gz > ~/post_procrad/rem/${SAMPLE}.rem.1.fq.gz &
	cat ~/post_procrad/lane1/plate4/${SAMPLE}.rem.2.fq.gz ~/post_procrad/lane2/plate4/${SAMPLE}.rem.2.fq.gz > ~/post_procrad/rem/${SAMPLE}.rem.2.fq.gz &
done




# Move remaining sample files into post_procrad directory

# D701
for SAMPLE in SS1_COMU_IM_10 SS2_TBMU_CI_01 SS3_TBMU_HU_15 \
SS4_TBMU_LA_07 TBMU_HA_17 TBMU_FJ_06TBMU_HA_12 TBMU_HA_16 TBMU_PL_23 \
TBMU_BI_18 COMU_HO_36 TBMU_KI_C8 TBMU_BI_15 TBMU_CI_11 COMU_BI_12 \
TBMU_KP_03 TBMU_KP_25 TBMU_BI_13 COMU_LA_09 TBMU_HA_13 COMU_IM_03 \
COMU_BI_19 TBMU_KI_62 TBMU_BI_11 TBMU_GC_36 TBMU_BI_20 COMU_IM_05 \
TBMU_FJ_12 COMU_BI_16 TBMU_KI_S1 TBMU_GC_45 TBMU_KP_07 TBMU_SV_17 \
TBMU_SV_20 COMU_BI_18 TBMU_FJ_02 COMU_HO_01 COMU_KP_05 TBMU_KI_I10 \
TBMU_SV_11 TBMU_KP_21 COMU_KP_06 TBMU_KI_56 TBMU_KI_I5 TBMU_BI_12 \
TBMU_SV_19 TBMU_FJ_07 COMU_BI_17
do
        ((i=i%N)); ((i++==0)) && wait
        mv ~/post_procrad/D701/${SAMPLE}.1.fq.gz ~/post_procrad/ &
        mv ~/post_procrad/D701/${SAMPLE}.2.fq.gz ~/post_procrad/ &
        mv ~/post_procrad/D701/${SAMPLE}.rem.1.fq.gz ~/post_procrad/rem/ &
        mv ~/post_procrad/D701/${SAMPLE}.rem.2.fq.gz ~/post_procrad/rem/ &
done



# D702
for SAMPLE in TBMU_GC_40 TBMU_FJ_05 COMU_HO_62 TBMU_KI_50 TBMU_SV_16 \
TBMU_KI_48 COMU_IM_13 TBMU_BI_17 TBMU_BI_04 TBMU_FJ_15 COMU_BI_08 \
TBMU_KP_16 COMU_IM_02 TBMU_HA_10 TBMU_KI_53 TBMU_HA_15 COMU_BI_20 \
TBMU_SV_12 COMU_BI_11 TBMU_BI_19 TBMU_CI_02 TBMU_SV_15 COMU_IM_06 \
COMU_KP_34 TBMU_GC_38 TBMU_KP_10 TBMU_KI_S3 TBMU_FJ_11 TBMU_FJ_10 \
TBMU_SV_14 COMU_KP_21 TBMU_CI_06 TBMU_KP_12 TBMU_BI_16 TBMU_PL_24 \
TBMU_KP_05 TBMU_FJ_09 COMU_BI_14 COMU_IM_04 TBMU_BI_14 TBMU_KP_31 \
TBMU_CI_03 TBMU_KP_15 TBMU_FJ_13 COMU_BI_13 TBMU_SV_13 TBMU_PL_46 \
TBMU_HA_14
do
        ((i=i%N)); ((i++==0)) && wait
        mv ~/post_procrad/D702/${SAMPLE}.1.fq.gz ~/post_procrad/ &
        mv ~/post_procrad/D702/${SAMPLE}.2.fq.gz ~/post_procrad/ &
        mv ~/post_procrad/D702/${SAMPLE}.rem.1.fq.gz ~/post_procrad/rem/ &
        mv ~/post_procrad/D702/${SAMPLE}.rem.2.fq.gz ~/post_procrad/rem/ &
done



# D703
for SAMPLE in SS5_COMU_IM_10 SS6_TBMU_CI_01 SS7_TBMU_HU_15 \
SS8_TBMU_LA_07 TBMU_KP_18 TBMU_BI_07 COMU_HO_61 \
TBMU_FJ_23 TBMU_GC_13 TBMU_FJ_22 TBMU_BI_10 TBMU_KP_14 TBMU_BI_01 \
COMU_BI_03 TBMU_BI_09 TBMU_KI_C4 TBMU_CI_18 COMU_BI_05 COMU_IM_01 \
TBMU_KP_08 COMU_HO_53 TBMU_GC_23 TBMU_KI_C1 TBMU_FJ_20 COMU_BI_09 \
COMU_KP_08 TBMU_BI_05 TBMU_KI_I3 TBMU_SV_10 TBMU_CI_14 TBMU_BI_03 \
TBMU_KI_S5 TBMU_FJ_24 COMU_KP_11 TBMU_KP_27 TBMU_SV_09 \
TBMU_SV_07 TBMU_KI_52 TBMU_FJ_17 TBMU_KI_C10 TBMU_SV_01_1 \
TBMU_GC_20_1
do
        ((i=i%N)); ((i++==0)) && wait
        mv ~/post_procrad/D703/${SAMPLE}.1.fq.gz ~/post_procrad/ &
        mv ~/post_procrad/D703/${SAMPLE}.2.fq.gz ~/post_procrad/ &
        mv ~/post_procrad/D703/${SAMPLE}.rem.1.fq.gz ~/post_procrad/rem/ &
        mv ~/post_procrad/D703/${SAMPLE}.rem.2.fq.gz ~/post_procrad/rem/ &
done




# D704
for SAMPLE in TBMU_PL_30 TBMU_HA_09 TBMU_KP_26 TBMU_FJ_19 COMU_BI_01 \
TBMU_CI_15 TBMU_SV_01 TBMU_GC_20 TBMU_PL_26 TBMU_FJ_16 COMU_BI_04 \
COMU_BI_06 TBMU_PL_29 TBMU_BI_08 TBMU_FJ_18 COMU_HO_54 COMU_HO_58 \
COMU_BI_10 TBMU_SV_05 TBMU_HA_96-15 COMU_HO_30 COMU_BI_02 TBMU_HA_07 \
TBMU_CI_21 TBMU_GC_15 TBMU_FJ_21 TBMU_KP_29 TBMU_CI_04 TBMU_KI_C3 \
TBMU_HA_08 TBMU_CI_20 TBMU_KP_17 TBMU_KP_19 COMU_HO_33 COMU_KP_07 \
TBMU_BI_06 TBMU_SV_03 TBMU_HA_04 TBMU_SV_06
do
        ((i=i%N)); ((i++==0)) && wait
        mv ~/post_procrad/D704/${SAMPLE}.1.fq.gz ~/post_procrad/ &
        mv ~/post_procrad/D704/${SAMPLE}.2.fq.gz ~/post_procrad/ &
        mv ~/post_procrad/D704/${SAMPLE}.rem.1.fq.gz ~/post_procrad/rem/ &
        mv ~/post_procrad/D704/${SAMPLE}.rem.2.fq.gz ~/post_procrad/rem/ &
done




# Gunzip all fastq files


# COMU
(
for SAMPLE in CM1-BR CM2-BR CM3-NOT CO11H CO12H CO13H CO14H CO15H CO16H \
CO17H CO18H CO19H CO1H CO20H CO21H CO22H CO23H CO24H CO25H \
CO26H CO27H CO28H CO29H CO2H CO30H CO31H CO32H CO33H CO34H \
CO35H CO36H CO37H CO38H CO39H CO40H CO41H CO42H CO43H CO44H \
CO45H CO46H CO47H CO48H CO49H CO4H CO50H CO5H CO6H CO7H CO8H \
CO9H COMU-BR-FI10 COMU-BR-FI12 COMU-BR-FI13 COMU-BR-FI14 COMU-BR-FI15 \
COMU-BR-FI16 COMU-BR-FI6 COMU-BR-FI7 COMU-BR-FI8 COMU-Bu-400 \
COMU-Bu-441 COMU-Bu-444 COMU-Bu-445 COMU-Bu-472 COMU-Bu-474 \
COMU-Bu-480 COMU-Bu-481 COMU-Bu-486 COMU-Bu-496 COMU-Bu-503 \
COMU-Bu-504 COMU-Bu-605 COMU-Bu-606 COMU-Bu-612 COMU-Bu-615 \
COMU-Bu-630 COMU-CMI-1 COMU-CMI-10 COMU-CMI-12 COMU-CMI-13 \
COMU-CMI-14 COMU-CMI-15 COMU-CMI-17 COMU-CMI-18 COMU-CMI-19 \
COMU-CMI-2 COMU-CMI-3 COMU-CMI-6 COMU-CMI-7 COMU-CMI-8 COMU-Den-1 \
COMU-Den-2 COMU-GC031-UN COMU-GC034-BR COMU-GC037-UN COMU-GC041-UN \
COMU-GC068-UN COMU-GC069-UN COMU-GC070-UN COMU-GC071-UN COMU-GC072-BR \
COMU-GC073-UN COMU-GC074-UN COMU-GC075-BR COMU-GI-10U COMU-GI-1U \
COMU-GI-29B COMU-GI-2U COMU-GI-30B COMU-GI-31B COMU-GI-32B \
COMU-GI-33B COMU-GI-34B COMU-GI-35B COMU-GI-36B COMU-GI-37B \
COMU-GI-38B COMU-GI-4U COMU-GI-6U COMU-GI-7U COMU-GI-8U COMU-GI-9U \
COMU-Ho-10B COMU-Ho-15U COMU-Ho-24U COMU-Ho-39U COMU-Ho-41U \
COMU-Ho-48U COMU-Ho-51B COMU-Ho-59U COMU-Ho-8B COMU-UAIM-10 \
COMU-UAIM-11 COMU-UAIM-12 COMU-UAIM-14 COMU-UAIM-15 COMU-UAIM-17 \
COMU-UAIM-18 COMU-UAIM-21 COMU-UAIM-22 COMU-UAIM-23 COMU-UAIM-24 \
COMU-UAIM-25 COMU-UAIM-26 COMU-UAIM-27 COMU-UAIM-28 COMU-UAIM-29 \
COMU-UAIM-30 COMU-UAIM-9 COMU-UaKP99-10 COMU-UaKP99-12 COMU-UaKP99-13 \
COMU-UaKP99-14 COMU-UaKP99-15 COMU-UaKP99-16 COMU-UaKP99-17 \
COMU-UaKP99-18 COMU-UaKP99-19 COMU-UaKP99-20 COMU-UaKP99-3 \
COMU-UaKP99-4 COMU-UaKP99-9 COMU-UN-FI17 COMU-UN-FI18 COMU-UN-FI19 \
COMU-UN-FI2 COMU-UN-FI20 COMU-UN-FI3 COMU-UN-FI4 COMU-UN-FI5 \
Ua-Den-10 Ua-Den-11 Ua-Den-12 Ua-Den-13 Ua-Den-15 Ua-Den-16 Ua-Den-17 \
Ua-Den-18 Ua-Den-3 Ua-Den-4 Ua-Den-5 Ua-Den-6 Ua-Den-8 Ua-Den-9 \
SS1_COMU_IM_10 COMU_HO_36 COMU_BI_12 COMU_LA_09 COMU_IM_03 COMU_BI_19 \
COMU_IM_05 COMU_BI_16 COMU_BI_18 COMU_HO_01 COMU_KP_05 COMU_KP_06 \
COMU_BI_17 COMU_HO_62 COMU_IM_02 COMU_BI_20 COMU_BI_11 COMU_IM_06 \
COMU_KP_34 COMU_KP_21 COMU_BI_14 COMU_IM_04 COMU_BI_13 COMU_IM_13 \
COMU_BI_08 SS5_COMU_IM_10 COMU_BI_03 COMU_BI_05 COMU_IM_01 COMU_HO_53 \
COMU_BI_09 COMU_KP_08 COMU_KP_11 COMU_HO_61 COMU_BI_01 COMU_BI_06 \
COMU_HO_54 COMU_HO_58 COMU_BI_10 COMU_HO_30 COMU_BI_02 COMU_HO_33 \
COMU_KP_07 COMU_BI_04
do
	((i=i%N)); ((i++==0)) && wait
	unpigz -k -p 4 --fast ~/post_procrad/${SAMPLE}.1.fq.gz &
	unpigz -k -p 4 --fast ~/post_procrad/${SAMPLE}.2.fq.gz &
	unpigz -k -p 4 --fast ~/post_procrad/rem/${SAMPLE}.rem.1.fq.gz &
	unpigz -k -p 4 --fast ~/post_procrad/rem/${SAMPLE}.rem.2.fq.gz &
done
)



# TBMU
(
for SAMPLE in TB30H TB31H TB32H TB1H TB2H TB4H TB5H TB7H TB8H TB9H \
TB10H TB11H TB12H TB13H TB15H TB16H TB17H TB18H TB19H \
TB20H TB22H TB24H TB25H TB26H TB27H TB28H TB29H TB33H \
TB34H TB35H TB36H TB37H TB38H TB39H TB40H TB41H TB42H \
TB43H TB44H TB45H TB46H TB47H TB48H TB49H TB50H \
TBMU-FI-1 TBMU-FI-2 TBMU-FI-3 TBMU-FI-4 TBMU-FI-5 \
TBMU-FI-6 TBMU-FI-7 TBMU-GC-014 TBMU-GC-016 \
TBMU-GC-017 TBMU-GC-018 TBMU-GC-019 TBMU-GC-021 \
TBMU-GC-024 TBMU-GC-025 TBMU-GC-026 TBMU-GC-027 \
TBMU-GC-029 TBMU-GC-030 TBMU-GC-032 TBMU-ULA-01 \
TBMU-ULA-02 TBMU-ULA-03 TBMU-ULA-04 TBMU-ULA-05 \
TBMU-ULA-06 TBMU-ULA-07 TBMU-ULA-08 TBMU-ULA-09 \
TBMU-ULA-11 TBMU-ULA-12 TBMU-ULA-13 TBMU-ULA-14 \
TBMU-ULA-15 TBMU-ULA-16 TBMU-ULA-18 TBMU-ULA-19 \
TBMU-ULA-20 TBMU-ULA-21 TBMU-ULA-22 TBMU-ULD-1 \
TBMU-ULD-2 TBMU-ULD-3 TBMU-ULD-4 TBMU-ULD-5 TBMU-ULD-6 \
TBMU-ULD-8 TBMU-ULD-9 TBMU-ULD-11 TBMU-ULD-12 \
TBMU-ULD-13 TBMU-ULD-14 TBMU-ULD-15 TBMU-ULD-16 \
TBMU-ULD-17 TBMU-ULD-18 TBMU-ULD-19 TBMU-ULD-20 \
TBMU-UL-L96-1 TBMU-UL-L96-3 TBMU-UL-L96-4 \
TBMU-UL-L96-5 TBMU-UL-L96-6 TBMU-UL-L96-7 TBMU-UL-L96-8 \
TBMU-UL-L96-9 TBMU-UL-L96-10 TBMU-UL-L96-11 \
TBMU-UL-L96-12 TBMU-UL-L96-13 TBMU-UL-L96-14 \
TBMU-UL-L96-15 TBMU-UL-L96-16 TBMU-UL-L96-17 \
TBMU-UL-L96-18 TBMU-UL-L96-19 TBMU-UL-L96-20 \
TBMU-ULH-584 TBMU-ULH-605 TBMU-ULH-607 TBMU-ULH-608 \
TBMU-ULH-609 TBMU-ULH-610 TBMU-ULH-611 TBMU-ULH-617 \
TBMU-ULH-618 TBMU-ULH-619 TBMU-ULH-621 TBMU-ULH-622-1 \
TBMU-ULH-624 TBMU-ULH-625 TBMU-ULH-644 TBMU-ULH-645 \
TBMU-ULH-647 TBMU-ULH-648 TBMU-ULH-649 TBMU-CB1d \
TBMU-CB2d TBMU-CB2c TBMU-CB6c TBMU-CB7c TBMU-CB8c \
TBMU-CB9c PLI-04-31 PLI-04-32 PLI-04-33 PLI-08-34 \
PLI-08-35 PLI-08-36 PLI-08-37 PLI-08-38 PLI-08-39 \
PLI-08-40 PLI-08-41 PLI-08-42 PLI-08-43 PLI-08-44 \
PLI-08-45 PLI-08-47 PLI-08-48 PLI-08-49 PLI-08-50 \
MW-08-01 MW-08-02 MW-08-03 MW-08-04 MW-08-05 MW-08-06 \
MW-08-07 MW-08-09 MW-08-10 MW-08-11 MW-08-12 MW-08-13 \
MW-08-14 MW-08-15 MW-08-16 MW-08-17 MW-08-18 MW-08-19 \
MW-08-20 V1 V2 V3 V5 V7 V8 V9 V10 V12 V13 V16 V17 V19 \
SS2_TBMU_CI_01 SS3_TBMU_HU_15 SS4_TBMU_LA_07 \
TBMU_HA_17 TBMU_FJ_06 TBMU_HA_12 TBMU_HA_16 \
TBMU_PL_23 TBMU_BI_18 TBMU_KI_C8 TBMU_BI_15 \
TBMU_CI_11 TBMU_KP_03 TBMU_KP_25 TBMU_BI_13 \
TBMU_HA_13 TBMU_KI_62 TBMU_BI_11 TBMU_GC_36 \
TBMU_BI_20 TBMU_FJ_12 TBMU_KI_S1 TBMU_GC_45 \
TBMU_KP_07 TBMU_SV_17 TBMU_SV_20 TBMU_FJ_02 \
TBMU_KI_I10 TBMU_SV_11 TBMU_KP_21 TBMU_KI_56 \
TBMU_KI_I5 TBMU_BI_12 TBMU_SV_19 TBMU_FJ_07 \
TBMU_GC_40 TBMU_FJ_05 TBMU_KI_50 TBMU_SV_16 \
TBMU_KI_48 TBMU_KP_16 TBMU_HA_10 TBMU_KI_53 \
TBMU_HA_15 TBMU_SV_12 TBMU_BI_19 TBMU_CI_02 \
TBMU_SV_15 TBMU_GC_38 TBMU_KP_10 TBMU_KI_S3 \
TBMU_FJ_11 TBMU_FJ_10 TBMU_SV_14 TBMU_CI_06 \
TBMU_KP_12 TBMU_BI_16 TBMU_PL_24 TBMU_KP_05 \
TBMU_FJ_09 TBMU_BI_14 TBMU_KP_31 TBMU_CI_03 \
TBMU_KP_15 TBMU_FJ_13 TBMU_SV_13 TBMU_PL_46 \
TBMU_HA_14 TBMU_BI_17 TBMU_BI_04 TBMU_FJ_15 \
SS6_TBMU_CI_01 SS7_TBMU_HU_15 SS8_TBMU_LA_07 \
TBMU_KP_18 TBMU_BI_07 TBMU_FJ_23 TBMU_GC_13 \
TBMU_FJ_22 TBMU_BI_10 TBMU_KP_14 TBMU_BI_01 \
TBMU_BI_09 TBMU_KI_C4 TBMU_CI_18 TBMU_KP_08 \
TBMU_GC_23 TBMU_KI_C1 TBMU_FJ_20 TBMU_BI_05 \
TBMU_KI_I3 TBMU_SV_10 TBMU_CI_14 TBMU_BI_03 \
TBMU_KI_S5 TBMU_FJ_24 TBMU_KP_27 TBMU_SV_09 \
TBMU_SV_01 TBMU_SV_07 TBMU_KI_52 TBMU_FJ_17 \
TBMU_KI_C10 TBMU_GC_20 TBMU_PL_30 TBMU_HA_09 \
TBMU_KP_26 TBMU_FJ_19 TBMU_CI_15 TBMU_PL_29 \
TBMU_BI_08 TBMU_FJ_18 TBMU_SV_05 TBMU_HA_96-15 \
TBMU_HA_07 TBMU_CI_21 TBMU_GC_15 TBMU_FJ_21 \
TBMU_KP_29 TBMU_CI_04 TBMU_KI_C3 TBMU_HA_08 \
TBMU_CI_20 TBMU_KP_17 TBMU_KP_19 TBMU_BI_06 \
TBMU_SV_03 TBMU_HA_04 TBMU_SV_06 TBMU_FJ_16 \
TBMU_PL_26 TBMU_SV_01_1 TBMU_GC_20_1
do
	((i=i%N)); ((i++==0)) && wait
	unpigz -k -p 4 --fast ~/post_procrad/${SAMPLE}.1.fq.gz &
	unpigz -k -p 4 --fast ~/post_procrad/${SAMPLE}.2.fq.gz &
	unpigz -k -p 4 --fast ~/post_procrad/rem/${SAMPLE}.rem.1.fq.gz &
	unpigz -k -p 4 --fast ~/post_procrad/rem/${SAMPLE}.rem.2.fq.gz &
done
)



# Concatenate the discarded reads

N=4
(
for SAMPLE in CM1-BR CM2-BR CM3-NOT CO11H CO12H CO13H CO14H CO15H CO16H \
CO17H CO18H CO19H CO1H CO20H CO21H CO22H CO23H CO24H CO25H \
CO26H CO27H CO28H CO29H CO2H CO30H CO31H CO32H CO33H CO34H \
CO35H CO36H CO37H CO38H CO39H CO40H CO41H CO42H CO43H CO44H \
CO45H CO46H CO47H CO48H CO49H CO4H CO50H CO5H CO6H CO7H CO8H \
CO9H COMU-BR-FI10 COMU-BR-FI12 COMU-BR-FI13 COMU-BR-FI14 COMU-BR-FI15 \
COMU-BR-FI16 COMU-BR-FI6 COMU-BR-FI7 COMU-BR-FI8 COMU-Bu-400 \
COMU-Bu-441 COMU-Bu-444 COMU-Bu-445 COMU-Bu-472 COMU-Bu-474 \
COMU-Bu-480 COMU-Bu-481 COMU-Bu-486 COMU-Bu-496 COMU-Bu-503 \
COMU-Bu-504 COMU-Bu-605 COMU-Bu-606 COMU-Bu-612 COMU-Bu-615 \
COMU-Bu-630 COMU-CMI-1 COMU-CMI-10 COMU-CMI-12 COMU-CMI-13 \
COMU-CMI-14 COMU-CMI-15 COMU-CMI-17 COMU-CMI-18 COMU-CMI-19 \
COMU-CMI-2 COMU-CMI-3 COMU-CMI-6 COMU-CMI-7 COMU-CMI-8 COMU-Den-1 \
COMU-Den-2 COMU-GC031-UN COMU-GC034-BR COMU-GC037-UN COMU-GC041-UN \
COMU-GC068-UN COMU-GC069-UN COMU-GC070-UN COMU-GC071-UN COMU-GC072-BR \
COMU-GC073-UN COMU-GC074-UN COMU-GC075-BR COMU-GI-10U COMU-GI-1U \
COMU-GI-29B COMU-GI-2U COMU-GI-30B COMU-GI-31B COMU-GI-32B \
COMU-GI-33B COMU-GI-34B COMU-GI-35B COMU-GI-36B COMU-GI-37B \
COMU-GI-38B COMU-GI-4U COMU-GI-6U COMU-GI-7U COMU-GI-8U COMU-GI-9U \
COMU-Ho-10B COMU-Ho-15U COMU-Ho-24U COMU-Ho-39U COMU-Ho-41U \
COMU-Ho-48U COMU-Ho-51B COMU-Ho-59U COMU-Ho-8B COMU-UAIM-10 \
COMU-UAIM-11 COMU-UAIM-12 COMU-UAIM-14 COMU-UAIM-15 COMU-UAIM-17 \
COMU-UAIM-18 COMU-UAIM-21 COMU-UAIM-22 COMU-UAIM-23 COMU-UAIM-24 \
COMU-UAIM-25 COMU-UAIM-26 COMU-UAIM-27 COMU-UAIM-28 COMU-UAIM-29 \
COMU-UAIM-30 COMU-UAIM-9 COMU-UaKP99-10 COMU-UaKP99-12 COMU-UaKP99-13 \
COMU-UaKP99-14 COMU-UaKP99-15 COMU-UaKP99-16 COMU-UaKP99-17 \
COMU-UaKP99-18 COMU-UaKP99-19 COMU-UaKP99-20 COMU-UaKP99-3 \
COMU-UaKP99-4 COMU-UaKP99-9 COMU-UN-FI17 COMU-UN-FI18 COMU-UN-FI19 \
COMU-UN-FI2 COMU-UN-FI20 COMU-UN-FI3 COMU-UN-FI4 COMU-UN-FI5 \
Ua-Den-10 Ua-Den-11 Ua-Den-12 Ua-Den-13 Ua-Den-15 Ua-Den-16 Ua-Den-17 \
Ua-Den-18 Ua-Den-3 Ua-Den-4 Ua-Den-5 Ua-Den-6 Ua-Den-8 Ua-Den-9 \
SS1_COMU_IM_10 COMU_HO_36 COMU_BI_12 COMU_LA_09 COMU_IM_03 COMU_BI_19 \
COMU_IM_05 COMU_BI_16 COMU_BI_18 COMU_HO_01 COMU_KP_05 COMU_KP_06 \
COMU_BI_17 COMU_HO_62 COMU_IM_02 COMU_BI_20 COMU_BI_11 COMU_IM_06 \
COMU_KP_34 COMU_KP_21 COMU_BI_14 COMU_IM_04 COMU_BI_13 COMU_IM_13 \
COMU_BI_08 SS5_COMU_IM_10 COMU_BI_03 COMU_BI_05 COMU_IM_01 COMU_HO_53 \
COMU_BI_09 COMU_KP_08 COMU_KP_11 COMU_HO_61 COMU_BI_01 COMU_BI_06 \
COMU_HO_54 COMU_HO_58 COMU_BI_10 COMU_HO_30 COMU_BI_02 COMU_HO_33 \
COMU_KP_07 COMU_BI_04 TB30H TB31H TB32H TB1H TB2H TB4H TB5H TB7H TB8H TB9H \
TB10H TB11H TB12H TB13H TB15H TB16H TB17H TB18H TB19H \
TB20H TB22H TB24H TB25H TB26H TB27H TB28H TB29H TB33H \
TB34H TB35H TB36H TB37H TB38H TB39H TB40H TB41H TB42H \
TB43H TB44H TB45H TB46H TB47H TB48H TB49H TB50H \
TBMU-FI-1 TBMU-FI-2 TBMU-FI-3 TBMU-FI-4 TBMU-FI-5 \
TBMU-FI-6 TBMU-FI-7 TBMU-GC-014 TBMU-GC-016 \
TBMU-GC-017 TBMU-GC-018 TBMU-GC-019 TBMU-GC-021 \
TBMU-GC-024 TBMU-GC-025 TBMU-GC-026 TBMU-GC-027 \
TBMU-GC-029 TBMU-GC-030 TBMU-GC-032 TBMU-ULA-01 \
TBMU-ULA-02 TBMU-ULA-03 TBMU-ULA-04 TBMU-ULA-05 \
TBMU-ULA-06 TBMU-ULA-07 TBMU-ULA-08 TBMU-ULA-09 \
TBMU-ULA-11 TBMU-ULA-12 TBMU-ULA-13 TBMU-ULA-14 \
TBMU-ULA-15 TBMU-ULA-16 TBMU-ULA-18 TBMU-ULA-19 \
TBMU-ULA-20 TBMU-ULA-21 TBMU-ULA-22 TBMU-ULD-1 \
TBMU-ULD-2 TBMU-ULD-3 TBMU-ULD-4 TBMU-ULD-5 TBMU-ULD-6 \
TBMU-ULD-8 TBMU-ULD-9 TBMU-ULD-11 TBMU-ULD-12 \
TBMU-ULD-13 TBMU-ULD-14 TBMU-ULD-15 TBMU-ULD-16 \
TBMU-ULD-17 TBMU-ULD-18 TBMU-ULD-19 TBMU-ULD-20 \
TBMU-UL-L96-1 TBMU-UL-L96-3 TBMU-UL-L96-4 \
TBMU-UL-L96-5 TBMU-UL-L96-6 TBMU-UL-L96-7 TBMU-UL-L96-8 \
TBMU-UL-L96-9 TBMU-UL-L96-10 TBMU-UL-L96-11 \
TBMU-UL-L96-12 TBMU-UL-L96-13 TBMU-UL-L96-14 \
TBMU-UL-L96-15 TBMU-UL-L96-16 TBMU-UL-L96-17 \
TBMU-UL-L96-18 TBMU-UL-L96-19 TBMU-UL-L96-20 \
TBMU-ULH-584 TBMU-ULH-605 TBMU-ULH-607 TBMU-ULH-608 \
TBMU-ULH-609 TBMU-ULH-610 TBMU-ULH-611 TBMU-ULH-617 \
TBMU-ULH-618 TBMU-ULH-619 TBMU-ULH-621 TBMU-ULH-622-1 \
TBMU-ULH-624 TBMU-ULH-625 TBMU-ULH-644 TBMU-ULH-645 \
TBMU-ULH-647 TBMU-ULH-648 TBMU-ULH-649 TBMU-CB1d \
TBMU-CB2d TBMU-CB2c TBMU-CB6c TBMU-CB7c TBMU-CB8c \
TBMU-CB9c PLI-04-31 PLI-04-32 PLI-04-33 PLI-08-34 \
PLI-08-35 PLI-08-36 PLI-08-37 PLI-08-38 PLI-08-39 \
PLI-08-40 PLI-08-41 PLI-08-42 PLI-08-43 PLI-08-44 \
PLI-08-45 PLI-08-47 PLI-08-48 PLI-08-49 PLI-08-50 \
MW-08-01 MW-08-02 MW-08-03 MW-08-04 MW-08-05 MW-08-06 \
MW-08-07 MW-08-09 MW-08-10 MW-08-11 MW-08-12 MW-08-13 \
MW-08-14 MW-08-15 MW-08-16 MW-08-17 MW-08-18 MW-08-19 \
MW-08-20 V1 V2 V3 V5 V7 V8 V9 V10 V12 V13 V16 V17 V19 \
SS2_TBMU_CI_01 SS3_TBMU_HU_15 SS4_TBMU_LA_07 \
TBMU_HA_17 TBMU_FJ_06 TBMU_HA_12 TBMU_HA_16 \
TBMU_PL_23 TBMU_BI_18 TBMU_KI_C8 TBMU_BI_15 \
TBMU_CI_11 TBMU_KP_03 TBMU_KP_25 TBMU_BI_13 \
TBMU_HA_13 TBMU_KI_62 TBMU_BI_11 TBMU_GC_36 \
TBMU_BI_20 TBMU_FJ_12 TBMU_KI_S1 TBMU_GC_45 \
TBMU_KP_07 TBMU_SV_17 TBMU_SV_20 TBMU_FJ_02 \
TBMU_KI_I10 TBMU_SV_11 TBMU_KP_21 TBMU_KI_56 \
TBMU_KI_I5 TBMU_BI_12 TBMU_SV_19 TBMU_FJ_07 \
TBMU_GC_40 TBMU_FJ_05 TBMU_KI_50 TBMU_SV_16 \
TBMU_KI_48 TBMU_KP_16 TBMU_HA_10 TBMU_KI_53 \
TBMU_HA_15 TBMU_SV_12 TBMU_BI_19 TBMU_CI_02 \
TBMU_SV_15 TBMU_GC_38 TBMU_KP_10 TBMU_KI_S3 \
TBMU_FJ_11 TBMU_FJ_10 TBMU_SV_14 TBMU_CI_06 \
TBMU_KP_12 TBMU_BI_16 TBMU_PL_24 TBMU_KP_05 \
TBMU_FJ_09 TBMU_BI_14 TBMU_KP_31 TBMU_CI_03 \
TBMU_KP_15 TBMU_FJ_13 TBMU_SV_13 TBMU_PL_46 \
TBMU_HA_14 TBMU_BI_17 TBMU_BI_04 TBMU_FJ_15 \
SS6_TBMU_CI_01 SS7_TBMU_HU_15 SS8_TBMU_LA_07 \
TBMU_KP_18 TBMU_BI_07 TBMU_FJ_23 TBMU_GC_13 \
TBMU_FJ_22 TBMU_BI_10 TBMU_KP_14 TBMU_BI_01 \
TBMU_BI_09 TBMU_KI_C4 TBMU_CI_18 TBMU_KP_08 \
TBMU_GC_23 TBMU_KI_C1 TBMU_FJ_20 TBMU_BI_05 \
TBMU_KI_I3 TBMU_SV_10 TBMU_CI_14 TBMU_BI_03 \
TBMU_KI_S5 TBMU_FJ_24 TBMU_KP_27 TBMU_SV_09 \
TBMU_SV_01 TBMU_SV_07 TBMU_KI_52 TBMU_FJ_17 \
TBMU_KI_C10 TBMU_GC_20 TBMU_PL_30 TBMU_HA_09 \
TBMU_KP_26 TBMU_FJ_19 TBMU_CI_15 TBMU_PL_29 \
TBMU_BI_08 TBMU_FJ_18 TBMU_SV_05 TBMU_HA_96-15 \
TBMU_HA_07 TBMU_CI_21 TBMU_GC_15 TBMU_FJ_21 \
TBMU_KP_29 TBMU_CI_04 TBMU_KI_C3 TBMU_HA_08 \
TBMU_CI_20 TBMU_KP_17 TBMU_KP_19 TBMU_BI_06 \
TBMU_SV_03 TBMU_HA_04 TBMU_SV_06 TBMU_FJ_16 \
TBMU_PL_26 TBMU_SV_01_1 TBMU_GC_20_1
do
	((i=i%N)); ((i++==0)) && wait
	cat ~/post_procrad/rem/${SAMPLE}.rem.1.fq ~/post_procrad/rem/${SAMPLE}.rem.2.fq \
		> ~/post_procrad/rem/${SAMPLE}.rem.fq &
done
)





# Load bowtie2/2.3.4.1 (default)

module load bowtie2



# Use bowtie 2 to align reads to genome
# Previously, all reads were mapped to the TBMU genome, but it would be better to map to the individual species' genome


# Convert genomes to indexes
# bowtie2-build -f ~/genomes/tbmu.fna tbmu_index
# bowtie2-build -f ~/genomes/comu.fna comu_index

# Align reads to indexed reference genome
# Bowtie2 run in loops by species



N=4
(
# COMU
for SAMPLE in CM1-BR CM2-BR CM3-NOT CO11H CO12H CO13H CO14H CO15H CO16H \
CO17H CO18H CO19H CO1H CO20H CO21H CO22H CO23H CO24H CO25H \
CO26H CO27H CO28H CO29H CO2H CO30H CO31H CO32H CO33H CO34H \
CO35H CO36H CO37H CO38H CO39H CO40H CO41H CO42H CO43H CO44H \
CO45H CO46H CO47H CO48H CO49H CO4H CO50H CO5H CO6H CO7H CO8H \
CO9H COMU-BR-FI10 COMU-BR-FI12 COMU-BR-FI13 COMU-BR-FI14 COMU-BR-FI15 \
COMU-BR-FI16 COMU-BR-FI6 COMU-BR-FI7 COMU-BR-FI8 COMU-Bu-400 \
COMU-Bu-441 COMU-Bu-444 COMU-Bu-445 COMU-Bu-472 COMU-Bu-474 \
COMU-Bu-480 COMU-Bu-481 COMU-Bu-486 COMU-Bu-496 COMU-Bu-503 \
COMU-Bu-504 COMU-Bu-605 COMU-Bu-606 COMU-Bu-612 COMU-Bu-615 \
COMU-Bu-630 COMU-CMI-1 COMU-CMI-10 COMU-CMI-12 COMU-CMI-13 \
COMU-CMI-14 COMU-CMI-15 COMU-CMI-17 COMU-CMI-18 COMU-CMI-19 \
COMU-CMI-2 COMU-CMI-3 COMU-CMI-6 COMU-CMI-7 COMU-CMI-8 COMU-Den-1 \
COMU-Den-2 COMU-GC031-UN COMU-GC034-BR COMU-GC037-UN COMU-GC041-UN \
COMU-GC068-UN COMU-GC069-UN COMU-GC070-UN COMU-GC071-UN COMU-GC072-BR \
COMU-GC073-UN COMU-GC074-UN COMU-GC075-BR COMU-GI-10U COMU-GI-1U \
COMU-GI-29B COMU-GI-2U COMU-GI-30B COMU-GI-31B COMU-GI-32B \
COMU-GI-33B COMU-GI-34B COMU-GI-35B COMU-GI-36B COMU-GI-37B \
COMU-GI-38B COMU-GI-4U COMU-GI-6U COMU-GI-7U COMU-GI-8U COMU-GI-9U \
COMU-Ho-10B COMU-Ho-15U COMU-Ho-24U COMU-Ho-39U COMU-Ho-41U \
COMU-Ho-48U COMU-Ho-51B COMU-Ho-59U COMU-Ho-8B COMU-UAIM-10 \
COMU-UAIM-11 COMU-UAIM-12 COMU-UAIM-14 COMU-UAIM-15 COMU-UAIM-17 \
COMU-UAIM-18 COMU-UAIM-21 COMU-UAIM-22 COMU-UAIM-23 COMU-UAIM-24 \
COMU-UAIM-25 COMU-UAIM-26 COMU-UAIM-27 COMU-UAIM-28 COMU-UAIM-29 \
COMU-UAIM-30 COMU-UAIM-9 COMU-UaKP99-10 COMU-UaKP99-12 COMU-UaKP99-13 \
COMU-UaKP99-14 COMU-UaKP99-15 COMU-UaKP99-16 COMU-UaKP99-17 \
COMU-UaKP99-18 COMU-UaKP99-19 COMU-UaKP99-20 COMU-UaKP99-3 \
COMU-UaKP99-4 COMU-UaKP99-9 COMU-UN-FI17 COMU-UN-FI18 COMU-UN-FI19 \
COMU-UN-FI2 COMU-UN-FI20 COMU-UN-FI3 COMU-UN-FI4 COMU-UN-FI5 \
Ua-Den-10 Ua-Den-11 Ua-Den-12 Ua-Den-13 Ua-Den-15 Ua-Den-16 Ua-Den-17 \
Ua-Den-18 Ua-Den-3 Ua-Den-4 Ua-Den-5 Ua-Den-6 Ua-Den-8 Ua-Den-9 \
SS1_COMU_IM_10 COMU_HO_36 COMU_BI_12 COMU_LA_09 COMU_IM_03 COMU_BI_19 \
COMU_IM_05 COMU_BI_16 COMU_BI_18 COMU_HO_01 COMU_KP_05 COMU_KP_06 \
COMU_BI_17 COMU_HO_62 COMU_IM_02 COMU_BI_20 COMU_BI_11 COMU_IM_06 \
COMU_KP_34 COMU_KP_21 COMU_BI_14 COMU_IM_04 COMU_BI_13 COMU_IM_13 \
COMU_BI_08 SS5_COMU_IM_10 COMU_BI_03 COMU_BI_05 COMU_IM_01 COMU_HO_53 \
COMU_BI_09 COMU_KP_08 COMU_KP_11 COMU_HO_61 COMU_BI_01 COMU_BI_06 \
COMU_HO_54 COMU_HO_58 COMU_BI_10 COMU_HO_30 COMU_BI_02 COMU_HO_33 \
COMU_KP_07 COMU_BI_04
do
	((i=i%N)); ((i++==0)) && wait
        bowtie2 -q --phred33 --end-to-end --very-sensitive --fr --time \
		-x ~/Scripts/comu_index \
                -1 ~/post_procrad/${SAMPLE}.1.fq \
                -2 ~/post_procrad/${SAMPLE}.2.fq \
                -U ~/post_procrad/rem/${SAMPLE}.rem.fq \
                -S ~/aligned/sam/COMU/${SAMPLE}.sam -p 4 &
done
)


(
# TBMU
for SAMPLE in TB30H TB31H TB32H TB1H TB2H TB4H TB5H TB7H TB8H TB9H \
TB10H TB11H TB12H TB13H TB15H TB16H TB17H TB18H TB19H \
TB20H TB22H TB24H TB25H TB26H TB27H TB28H TB29H TB33H \
TB34H TB35H TB36H TB37H TB38H TB39H TB40H TB41H TB42H \
TB43H TB44H TB45H TB46H TB47H TB48H TB49H TB50H \
TBMU-FI-1 TBMU-FI-2 TBMU-FI-3 TBMU-FI-4 TBMU-FI-5 \
TBMU-FI-6 TBMU-FI-7 TBMU-GC-014 TBMU-GC-016 \
TBMU-GC-017 TBMU-GC-018 TBMU-GC-019 TBMU-GC-021 \
TBMU-GC-024 TBMU-GC-025 TBMU-GC-026 TBMU-GC-027 \
TBMU-GC-029 TBMU-GC-030 TBMU-GC-032 TBMU-ULA-01 \
TBMU-ULA-02 TBMU-ULA-03 TBMU-ULA-04 TBMU-ULA-05 \
TBMU-ULA-06 TBMU-ULA-07 TBMU-ULA-08 TBMU-ULA-09 \
TBMU-ULA-11 TBMU-ULA-12 TBMU-ULA-13 TBMU-ULA-14 \
TBMU-ULA-15 TBMU-ULA-16 TBMU-ULA-18 TBMU-ULA-19 \
TBMU-ULA-20 TBMU-ULA-21 TBMU-ULA-22 TBMU-ULD-1 \
TBMU-ULD-2 TBMU-ULD-3 TBMU-ULD-4 TBMU-ULD-5 TBMU-ULD-6 \
TBMU-ULD-8 TBMU-ULD-9 TBMU-ULD-11 TBMU-ULD-12 \
TBMU-ULD-13 TBMU-ULD-14 TBMU-ULD-15 TBMU-ULD-16 \
TBMU-ULD-17 TBMU-ULD-18 TBMU-ULD-19 TBMU-ULD-20 \
TBMU-UL-L96-1 TBMU-UL-L96-3 TBMU-UL-L96-4 \
TBMU-UL-L96-5 TBMU-UL-L96-6 TBMU-UL-L96-7 TBMU-UL-L96-8 \
TBMU-UL-L96-9 TBMU-UL-L96-10 TBMU-UL-L96-11 \
TBMU-UL-L96-12 TBMU-UL-L96-13 TBMU-UL-L96-14 \
TBMU-UL-L96-15 TBMU-UL-L96-16 TBMU-UL-L96-17 \
TBMU-UL-L96-18 TBMU-UL-L96-19 TBMU-UL-L96-20 \
TBMU-ULH-584 TBMU-ULH-605 TBMU-ULH-607 TBMU-ULH-608 \
TBMU-ULH-609 TBMU-ULH-610 TBMU-ULH-611 TBMU-ULH-617 \
TBMU-ULH-618 TBMU-ULH-619 TBMU-ULH-621 TBMU-ULH-622-1 \
TBMU-ULH-624 TBMU-ULH-625 TBMU-ULH-644 TBMU-ULH-645 \
TBMU-ULH-647 TBMU-ULH-648 TBMU-ULH-649 TBMU-CB1d \
TBMU-CB2d TBMU-CB2c TBMU-CB6c TBMU-CB7c TBMU-CB8c \
TBMU-CB9c PLI-04-31 PLI-04-32 PLI-04-33 PLI-08-34 \
PLI-08-35 PLI-08-36 PLI-08-37 PLI-08-38 PLI-08-39 \
PLI-08-40 PLI-08-41 PLI-08-42 PLI-08-43 PLI-08-44 \
PLI-08-45 PLI-08-47 PLI-08-48 PLI-08-49 PLI-08-50 \
MW-08-01 MW-08-02 MW-08-03 MW-08-04 MW-08-05 MW-08-06 \
MW-08-07 MW-08-09 MW-08-10 MW-08-11 MW-08-12 MW-08-13 \
MW-08-14 MW-08-15 MW-08-16 MW-08-17 MW-08-18 MW-08-19 \
MW-08-20 V1 V2 V3 V5 V7 V8 V9 V10 V12 V13 V16 V17 V19 \
SS2_TBMU_CI_01 SS3_TBMU_HU_15 SS4_TBMU_LA_07 \
TBMU_HA_17 TBMU_FJ_06 TBMU_HA_12 TBMU_HA_16 \
TBMU_PL_23 TBMU_BI_18 TBMU_KI_C8 TBMU_BI_15 \
TBMU_CI_11 TBMU_KP_03 TBMU_KP_25 TBMU_BI_13 \
TBMU_HA_13 TBMU_KI_62 TBMU_BI_11 TBMU_GC_36 \
TBMU_BI_20 TBMU_FJ_12 TBMU_KI_S1 TBMU_GC_45 \
TBMU_KP_07 TBMU_SV_17 TBMU_SV_20 TBMU_FJ_02 \
TBMU_KI_I10 TBMU_SV_11 TBMU_KP_21 TBMU_KI_56 \
TBMU_KI_I5 TBMU_BI_12 TBMU_SV_19 TBMU_FJ_07 \
TBMU_GC_40 TBMU_FJ_05 TBMU_KI_50 TBMU_SV_16 \
TBMU_KI_48 TBMU_KP_16 TBMU_HA_10 TBMU_KI_53 \
TBMU_HA_15 TBMU_SV_12 TBMU_BI_19 TBMU_CI_02 \
TBMU_SV_15 TBMU_GC_38 TBMU_KP_10 TBMU_KI_S3 \
TBMU_FJ_11 TBMU_FJ_10 TBMU_SV_14 TBMU_CI_06 \
TBMU_KP_12 TBMU_BI_16 TBMU_PL_24 TBMU_KP_05 \
TBMU_FJ_09 TBMU_BI_14 TBMU_KP_31 TBMU_CI_03 \
TBMU_KP_15 TBMU_FJ_13 TBMU_SV_13 TBMU_PL_46 \
TBMU_HA_14 TBMU_BI_17 TBMU_BI_04 TBMU_FJ_15 \
SS6_TBMU_CI_01 SS7_TBMU_HU_15 SS8_TBMU_LA_07 \
TBMU_KP_18 TBMU_BI_07 TBMU_FJ_23 TBMU_GC_13 \
TBMU_FJ_22 TBMU_BI_10 TBMU_KP_14 TBMU_BI_01 \
TBMU_BI_09 TBMU_KI_C4 TBMU_CI_18 TBMU_KP_08 \
TBMU_GC_23 TBMU_KI_C1 TBMU_FJ_20 TBMU_BI_05 \
TBMU_KI_I3 TBMU_SV_10 TBMU_CI_14 TBMU_BI_03 \
TBMU_KI_S5 TBMU_FJ_24 TBMU_KP_27 TBMU_SV_09 \
TBMU_SV_01 TBMU_SV_07 TBMU_KI_52 TBMU_FJ_17 \
TBMU_KI_C10 TBMU_GC_20 TBMU_PL_30 TBMU_HA_09 \
TBMU_KP_26 TBMU_FJ_19 TBMU_CI_15 TBMU_PL_29 \
TBMU_BI_08 TBMU_FJ_18 TBMU_SV_05 TBMU_HA_96-15 \
TBMU_HA_07 TBMU_CI_21 TBMU_GC_15 TBMU_FJ_21 \
TBMU_KP_29 TBMU_CI_04 TBMU_KI_C3 TBMU_HA_08 \
TBMU_CI_20 TBMU_KP_17 TBMU_KP_19 TBMU_BI_06 \
TBMU_SV_03 TBMU_HA_04 TBMU_SV_06 TBMU_FJ_16 \
TBMU_PL_26 TBMU_SV_01_1 TBMU_GC_20_1
do
	((i=i%N)); ((i++==0)) && wait
        bowtie2 -q --phred33 --end-to-end --very-sensitive --fr --time \
		-x ~/Scripts/tbmu_index \
                -1 ~/post_procrad/${SAMPLE}.1.fq \
                -2 ~/post_procrad/${SAMPLE}.2.fq \
                -U ~/post_procrad/rem/${SAMPLE}.rem.fq \
                -S ~/aligned/sam/TBMU/${SAMPLE}.sam -p 4 &
done
)
